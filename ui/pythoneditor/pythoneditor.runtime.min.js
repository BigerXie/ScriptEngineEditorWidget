TW.Runtime.Widgets.pythoneditor=function(){function f(){try{d=monaco.editor.create(document.getElementById("widget-pythoneditor-ParametersMonaco_"+a),{value:"",language:"json",scrollBeyondLastLine:!1,theme:"vs"}),e=monaco.editor.create(document.getElementById("widget-pythoneditor-PythonMonaco_"+a),{value:"",language:"python",scrollBeyondLastLine:!1,theme:"vs"})}catch(b){e=d=null,$("#widget-pythoneditor-ParametersMonaco_"+a).css("display","none"),$("#widget-pythoneditor-PythonMonaco_"+a).css("display",
"none"),$(".widget-pythoneditor-ParametersTextArea_"+a).css("display","block"),$(".widget-pythoneditor-PythonTextArea_"+a).css("display","block")}c.addEvents();c.updateEditor()}var d,e,c=this,a=(new Date).getTime()+"_"+Math.floor(1E3*Math.random());this.runtimeProperties=function(){return{needsDataLoadingAndError:!1,supportsAutoResize:!0}};this.renderHtml=function(){return'<div class="widget-content widget-pythoneditor widget-pythoneditor widget-pythoneditor-'+a+'">  <label class="widget-pythoneditor-label">Parameters</label>  <textarea class="widget-pythoneditor-ParametersTextArea widget-pythoneditor-ParametersTextArea_'+
a+'"></textarea>  <div id="widget-pythoneditor-ParametersMonaco_'+a+'" class="widget-pythoneditor-ParametersMonaco"></div>  <label class="widget-pythoneditor-label widget-pythoneditor-top10">Result Parameter</label>  <input type="text" class="widget-pythoneditor-ResultParameter widget-pythoneditor-ResultParameter_'+a+'"/>  <label class="widget-pythoneditor-label widget-pythoneditor-top10">Code</label>  <textarea class="widget-pythoneditor-PythonTextArea widget-pythoneditor-PythonTextArea_'+a+'"></textarea>  <div id="widget-pythoneditor-PythonMonaco_'+
a+'" class="widget-pythoneditor-PythonMonaco"></div>  <div class="widget-pythoneditor-top10" style="text-align:right">\t   <div class="widget-pythoneditor-run widget-pythoneditor-run_'+a+'">Run</div>  </div>  <label class="widget-pythoneditor-label widget-pythoneditor-top10">Result</label>  <input type="text" class="widget-pythoneditor-Result widget-pythoneditor-Result_'+a+'" readonly/></div>'};this.afterRender=function(){try{if(window.monaco&&monaco.editor)f();else{require.config({paths:{vs:"https://unpkg.com/monaco-editor@latest/min/vs"}});
window.MonacoEnvironment={getWorkerUrl:()=>b};var b=URL.createObjectURL(new Blob(["\n          self.MonacoEnvironment = {baseUrl: 'https://unpkg.com/monaco-editor@latest/min/'};\n          importScripts('https://unpkg.com/monaco-editor@latest/min/vs/base/worker/workerMain.js');\n        "],{type:"text/javascript"}));require(["vs/editor/editor.main"],f)}}catch(h){e=d=null,$("#widget-pythoneditor-ParametersMonaco_"+a).css("display","none"),$("#widget-pythoneditor-PythonMonaco_"+a).css("display","none"),
$(".widget-pythoneditor-ParametersTextArea_"+a).css("display","block"),$(".widget-pythoneditor-PythonTextArea_"+a).css("display","block"),c.addEvents(),c.updateEditor()}};this.serviceInvoked=function(a){};this.updateProperty=function(a){"debugMode"===a.TargetProperty?this.setProperty(a.TargetProperty,a.RawSinglePropertyValue):"parameters"===a.TargetProperty?(this.setProperty(a.TargetProperty,a.RawSinglePropertyValue),this.updateEditor()):"resultParameter"===a.TargetProperty?(this.setProperty(a.TargetProperty,
a.RawSinglePropertyValue),this.updateEditor()):"code"===a.TargetProperty&&(this.setProperty(a.TargetProperty,a.RawSinglePropertyValue),this.updateEditor())};this.addEvents=function(){if(d)d.getModel().onDidChangeContent(()=>{try{c.setProperty("parameters",JSON.parse(d.getModel().getValue()))}catch(b){}});else document.getElementsByClassName("widget-pythoneditor-ParametersTextArea_"+a)[0].oninput=()=>{try{c.setProperty("parameters",JSON.parse(event.srcElement.value))}catch(b){}},document.getElementsByClassName("widget-pythoneditor-ParametersTextArea_"+
a)[0].onchange=()=>{try{c.setProperty("parameters",JSON.parse(event.srcElement.value))}catch(b){}};document.getElementsByClassName("widget-pythoneditor-ResultParameter_"+a)[0].oninput=()=>c.setProperty("resultParameter",event.srcElement.value);document.getElementsByClassName("widget-pythoneditor-ResultParameter_"+a)[0].onchange=()=>c.setProperty("resultParameter",event.srcElement.value);if(e)e.getModel().onDidChangeContent(()=>c.setProperty("code",e.getModel().getValue()));else document.getElementsByClassName("widget-pythoneditor-PythonTextArea_"+
a)[0].oninput=()=>c.setProperty("code",event.srcElement.value),document.getElementsByClassName("widget-pythoneditor-PythonTextArea_"+a)[0].onchange=()=>c.setProperty("code",event.srcElement.value);document.getElementsByClassName("widget-pythoneditor-run_"+a)[0].onclick=()=>{if(!$(".widget-pythoneditor-run_"+a).hasClass("widget-pythoneditor-run-disabled")){c.setEnabled(!1);var b=new ThingworxInvoker({entityType:"Resources",entityName:"PythonResource",characteristic:"Services",target:"exec",apiMethod:"POST"});
b.setParameterValue("parameters",c.getProperty("parameters"));b.setParameterValue("resultParameter",c.getProperty("resultParameter"));b.setParameterValue("code",c.getProperty("code"));b.invokeService(function(b){document.getElementsByClassName("widget-pythoneditor-Result_"+a)[0].value=JSON.stringify(b.result.rows[0].result.value);c.setEnabled(!0)},function(b,d){document.getElementsByClassName("widget-pythoneditor-Result_"+a)[0].value=d.responseText;c.setEnabled(!0)})}}};this.updateEditor=function(){var b=
c.getProperty("parameters"),f=c.getProperty("resultParameter"),g=c.getProperty("code");d?d.getModel().setValue(b):document.getElementsByClassName("widget-pythoneditor-ParametersTextArea_"+a)[0].value=b;document.getElementsByClassName("widget-pythoneditor-ResultParameter_"+a)[0].value=f;e?e.getModel().setValue(g):document.getElementsByClassName("widget-pythoneditor-PythonTextArea_"+a)[0].value=g};this.setEnabled=function(b){d?d.updateOptions({readOnly:!b}):document.getElementsByClassName("widget-pythoneditor-ParametersTextArea_"+
a)[0].disabled=b?"":"disabled";document.getElementsByClassName("widget-pythoneditor-ResultParameter_"+a)[0].disabled=b?"":"disabled";e?e.updateOptions({readOnly:!b}):document.getElementsByClassName("widget-pythoneditor-PythonTextArea_"+a)[0].disabled=b?"":"disabled";b?$(".widget-pythoneditor-run_"+a).removeClass("widget-pythoneditor-run-disabled"):$(".widget-pythoneditor-run_"+a).addClass("widget-pythoneditor-run-disabled")};this.beforeDestroy=function(){try{console.log("Python Editor -> destroy editors"),
TW.log.info("Python Editor -> destroy editors"),d&&(d.getModel().dispose(),d.dispose(),d=null),e&&(e.getModel().dispose(),e.dispose(),e=null)}catch(b){TW.log.error("Python Editor Before Destroy Error",b)}}};