TW.Runtime.Widgets.scriptengineeditor=function(){function f(){try{d=monaco.editor.create(document.getElementById("widget-scriptengineeditor-ParametersMonaco_"+a),{value:"",language:"json",scrollBeyondLastLine:!1,theme:"vs",minimap:{enabled:!1}}),e=monaco.editor.create(document.getElementById("widget-scriptengineeditor-ScriptEngineMonaco_"+a),{value:"",language:"python",scrollBeyondLastLine:!1,theme:"vs",minimap:{enabled:!1}})}catch(b){e=d=null,$("#widget-scriptengineeditor-ParametersMonaco_"+a).css("display",
"none"),$("#widget-scriptengineeditor-ScriptEngineMonaco_"+a).css("display","none"),$(".widget-scriptengineeditor-ParametersTextArea_"+a).css("display","block"),$(".widget-scriptengineeditor-ScriptEngineTextArea_"+a).css("display","block")}c.addEvents();c.updateEditor()}var d,e,c=this,a=(new Date).getTime()+"_"+Math.floor(1E3*Math.random());this.runtimeProperties=function(){return{needsDataLoadingAndError:!1,supportsAutoResize:!0}};this.renderHtml=function(){return'<div class="widget-content widget-scriptengineeditor widget-scriptengineeditor widget-scriptengineeditor-'+
a+'">  <label class="widget-scriptengineeditor-label">Parameters</label>  <textarea class="widget-scriptengineeditor-ParametersTextArea widget-scriptengineeditor-ParametersTextArea_'+a+'"></textarea>  <div id="widget-scriptengineeditor-ParametersMonaco_'+a+'" class="widget-scriptengineeditor-ParametersMonaco"></div>  <label class="widget-scriptengineeditor-label widget-scriptengineeditor-top10">Result Parameter</label>  <input type="text" class="widget-scriptengineeditor-ResultParameter widget-scriptengineeditor-ResultParameter_'+
a+'"/>  <label class="widget-scriptengineeditor-label widget-scriptengineeditor-top10">Code</label>  <textarea class="widget-scriptengineeditor-ScriptEngineTextArea widget-scriptengineeditor-ScriptEngineTextArea_'+a+'"></textarea>  <div id="widget-scriptengineeditor-ScriptEngineMonaco_'+a+'" class="widget-scriptengineeditor-ScriptEngineMonaco"></div>  <div class="widget-scriptengineeditor-top10" style="text-align:right">\t   <div class="widget-scriptengineeditor-run widget-scriptengineeditor-run_'+
a+'">Run</div>  </div>  <label class="widget-scriptengineeditor-label widget-scriptengineeditor-top10">Result</label>  <input type="text" class="widget-scriptengineeditor-Result widget-scriptengineeditor-Result_'+a+'" readonly/></div>'};this.afterRender=function(){try{if(window.monaco&&monaco.editor)f();else{require.config({paths:{vs:"https://unpkg.com/monaco-editor@latest/min/vs"}});window.MonacoEnvironment={getWorkerUrl:()=>b};var b=URL.createObjectURL(new Blob(["\n          self.MonacoEnvironment = {baseUrl: 'https://unpkg.com/monaco-editor@latest/min/'};\n          importScripts('https://unpkg.com/monaco-editor@latest/min/vs/base/worker/workerMain.js');\n        "],
{type:"text/javascript"}));require(["vs/editor/editor.main"],f)}}catch(h){e=d=null,$("#widget-scriptengineeditor-ParametersMonaco_"+a).css("display","none"),$("#widget-scriptengineeditor-ScriptEngineMonaco_"+a).css("display","none"),$(".widget-scriptengineeditor-ParametersTextArea_"+a).css("display","block"),$(".widget-scriptengineeditor-ScriptEngineTextArea_"+a).css("display","block"),c.addEvents(),c.updateEditor()}};this.serviceInvoked=function(a){};this.updateProperty=function(a){"debugMode"===
a.TargetProperty?this.setProperty(a.TargetProperty,a.RawSinglePropertyValue):"parameters"===a.TargetProperty?(this.setProperty(a.TargetProperty,a.RawSinglePropertyValue),this.updateEditor()):"resultParameter"===a.TargetProperty?(this.setProperty(a.TargetProperty,a.RawSinglePropertyValue),this.updateEditor()):"code"===a.TargetProperty&&(this.setProperty(a.TargetProperty,a.RawSinglePropertyValue),this.updateEditor())};this.addEvents=function(){if(d)d.getModel().onDidChangeContent(()=>{try{c.setProperty("parameters",
JSON.parse(d.getModel().getValue()))}catch(b){}});else document.getElementsByClassName("widget-scriptengineeditor-ParametersTextArea_"+a)[0].oninput=()=>{try{c.setProperty("parameters",JSON.parse(event.srcElement.value))}catch(b){}},document.getElementsByClassName("widget-scriptengineeditor-ParametersTextArea_"+a)[0].onchange=()=>{try{c.setProperty("parameters",JSON.parse(event.srcElement.value))}catch(b){}};document.getElementsByClassName("widget-scriptengineeditor-ResultParameter_"+a)[0].oninput=
()=>c.setProperty("resultParameter",event.srcElement.value);document.getElementsByClassName("widget-scriptengineeditor-ResultParameter_"+a)[0].onchange=()=>c.setProperty("resultParameter",event.srcElement.value);if(e)e.getModel().onDidChangeContent(()=>c.setProperty("code",e.getModel().getValue()));else document.getElementsByClassName("widget-scriptengineeditor-ScriptEngineTextArea_"+a)[0].oninput=()=>c.setProperty("code",event.srcElement.value),document.getElementsByClassName("widget-scriptengineeditor-ScriptEngineTextArea_"+
a)[0].onchange=()=>c.setProperty("code",event.srcElement.value);document.getElementsByClassName("widget-scriptengineeditor-run_"+a)[0].onclick=()=>{if(!$(".widget-scriptengineeditor-run_"+a).hasClass("widget-scriptengineeditor-run-disabled")){c.setEnabled(!1);var b=new ThingworxInvoker({entityType:"Resources",entityName:"ScriptEngineResource",characteristic:"Services",target:"exec",apiMethod:"POST"});b.setParameterValue("parameters",c.getProperty("parameters"));b.setParameterValue("resultParameter",
c.getProperty("resultParameter"));b.setParameterValue("code",c.getProperty("code"));b.invokeService(function(b){document.getElementsByClassName("widget-scriptengineeditor-Result_"+a)[0].value=JSON.stringify(b.result.rows[0].result.value);c.setEnabled(!0)},function(b,d){document.getElementsByClassName("widget-scriptengineeditor-Result_"+a)[0].value=d.responseText;c.setEnabled(!0)})}}};this.updateEditor=function(){var b=c.getProperty("parameters"),f=c.getProperty("resultParameter"),g=c.getProperty("code");
d?d.getModel().setValue(b):document.getElementsByClassName("widget-scriptengineeditor-ParametersTextArea_"+a)[0].value=b;document.getElementsByClassName("widget-scriptengineeditor-ResultParameter_"+a)[0].value=f;e?e.getModel().setValue(g):document.getElementsByClassName("widget-scriptengineeditor-ScriptEngineTextArea_"+a)[0].value=g};this.setEnabled=function(b){d?d.updateOptions({readOnly:!b}):document.getElementsByClassName("widget-scriptengineeditor-ParametersTextArea_"+a)[0].disabled=b?"":"disabled";
document.getElementsByClassName("widget-scriptengineeditor-ResultParameter_"+a)[0].disabled=b?"":"disabled";e?e.updateOptions({readOnly:!b}):document.getElementsByClassName("widget-scriptengineeditor-ScriptEngineTextArea_"+a)[0].disabled=b?"":"disabled";b?$(".widget-scriptengineeditor-run_"+a).removeClass("widget-scriptengineeditor-run-disabled"):$(".widget-scriptengineeditor-run_"+a).addClass("widget-scriptengineeditor-run-disabled")};this.beforeDestroy=function(){try{console.log("ScriptEngine Editor -> destroy editors"),
TW.log.info("ScriptEngine Editor -> destroy editors"),d&&(d.getModel().dispose(),d.dispose(),d=null),e&&(e.getModel().dispose(),e.dispose(),e=null)}catch(b){TW.log.error("ScriptEngine Editor Before Destroy Error",b)}}};